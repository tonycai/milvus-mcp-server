# Milvus MCP Server Changes

## 2025-04-23: Fixed Collection Creation and Data Insertion

### Bug Fixes:
1. Fixed issues with collection creation in MilvusConnector:
   - Added automatic conversion of string data types to DataType enum values
   - Enhanced error handling for field type conversion
   - Added support for minimal collection creation parameters

2. Improved vector data handling in insert_data method:
   - Added special handling for vector fields
   - Improved handling of numpy arrays and nested lists
   - Added fallback mechanism for different vector formats

3. Updated CLAUDE.md with:
   - Correct command syntax
   - Known issues and workarounds for Milvus vector data types
   - Best practices for collection creation and data insertion

### Implementation Details:
- Modified create_collection method to handle string type names (e.g., "INT64" â†’ DataType.INT64)
- Added preprocessing for other_fields to ensure proper data types
- Added fallback to minimal collection creation when dimension is the only parameter
- Enhanced vector data format handling to support both numpy arrays and nested lists
- Added error recovery attempts during data insertion
- Documented workarounds for known Milvus vector format issues

### Test Scripts:
- Created multiple test scripts to verify functionality:
  - create_collection_directly.py: Tests direct collection creation
  - insert_data_directly.py: Tests vector data insertion
  - working_example.py: Demonstrates working ORM and Client API usage
  - simplified_client.py: Shows minimal working example